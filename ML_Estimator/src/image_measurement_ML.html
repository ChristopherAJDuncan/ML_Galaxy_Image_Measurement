
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module image_measurement_ML</title>
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>image_measurement_ML</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/disk1/cajd/Euclid/ML_Estimator/src/image_measurement_ML.py">/disk1/cajd/Euclid/ML_Estimator/src/image_measurement_ML.py</a></font></td></tr></table>
    <p><tt>Author:&nbsp;cajd<br>
Touch&nbsp;Date:&nbsp;14th&nbsp;May&nbsp;2015<br>
Purpose:&nbsp;Contains&nbsp;the&nbsp;code&nbsp;to&nbsp;implement&nbsp;a&nbsp;maximum-likelihood&nbsp;based&nbsp;estimator&nbsp;for&nbsp;image&nbsp;model&nbsp;parameters.&nbsp;Contains&nbsp;routines&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;log-Likelihood,&nbsp;and&nbsp;it's&nbsp;derivatives,&nbsp;as&nbsp;well&nbsp;as&nbsp;supplementary&nbsp;definitions&nbsp;such&nbsp;as&nbsp;mimimisation&nbsp;routines&nbsp;(if&nbsp;applicable),&nbsp;noise&nbsp;estimation&nbsp;from&nbsp;an&nbsp;image,&nbsp;and&nbsp;error&nbsp;estiamtion&nbsp;(e.g.&nbsp;Fisher&nbsp;Matrices).<br>
&nbsp;<br>
To&nbsp;Do:<br>
(17Sept2015)::&nbsp;Add&nbsp;ability&nbsp;to&nbsp;apply&nbsp;a&nbsp;prior&nbsp;to&nbsp;the&nbsp;likelihood&nbsp;(in&nbsp;which&nbsp;case&nbsp;the&nbsp;method&nbsp;maximises&nbsp;a&nbsp;*Posterior*&nbsp;rather&nbsp;than&nbsp;a&nbsp;likelihood.&nbsp;In&nbsp;this&nbsp;case,&nbsp;lnL&nbsp;-&gt;&nbsp;lnP&nbsp;+&nbsp;lnL&nbsp;and&nbsp;d^n(lnL)&nbsp;-&gt;&nbsp;d^n(lnP)&nbsp;+&nbsp;d^n&nbsp;(lnL)</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="galsim.html">galsim</a><br>
</td><td width="25%" valign=top><a href="numpy.html">numpy</a><br>
</td><td width="25%" valign=top><a href="os.html">os</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-differentiate_logLikelihood_Gaussian_Analytic"><strong>differentiate_logLikelihood_Gaussian_Analytic</strong></a>(parameters, pLabels, image, setParams, modelLookup<font color="#909090">=None</font>, returnType<font color="#909090">=None</font>, order<font color="#909090">=1</font>, signModifier<font color="#909090">=-1.0</font>)</dt></dl>
 <dl><dt><a name="-estimate_Noise"><strong>estimate_Noise</strong></a>(image, maskCentroid<font color="#909090">=None</font>)</dt><dd><tt>Routine&nbsp;which&nbsp;takes&nbsp;in&nbsp;an&nbsp;image&nbsp;and&nbsp;estimates&nbsp;the&nbsp;noise,&nbsp;needed&nbsp;to&nbsp;accurately&nbsp;calculate&nbsp;the&nbsp;expected&nbsp;bias&nbsp;on&nbsp;profile&nbsp;measurements.&nbsp;Where&nbsp;a&nbsp;centroid&nbsp;value&nbsp;is&nbsp;passed,&nbsp;the&nbsp;code&nbsp;uses&nbsp;a&nbsp;form&nbsp;of&nbsp;`curve&nbsp;of&nbsp;growth`&nbsp;to&nbsp;estiamte&nbsp;the&nbsp;noise,&nbsp;by&nbsp;increasing&nbsp;the&nbsp;size&nbsp;of&nbsp;a&nbsp;cricular&nbsp;mask&nbsp;steadily&nbsp;by&nbsp;one&nbsp;pixel&nbsp;around&nbsp;that&nbsp;centroid&nbsp;and&nbsp;looking&nbsp;for&nbsp;convergence&nbsp;(defined&nbsp;here&nbsp;as&nbsp;the&nbsp;point&nbsp;where&nbsp;the&nbsp;difference&nbsp;between&nbsp;loops&nbsp;is&nbsp;minimised),&nbsp;otherwise&nbsp;the&nbsp;full&nbsp;image&nbsp;is&nbsp;used.<br>
&nbsp;<br>
***&nbsp;Noise&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;too&nbsp;large&nbsp;when&nbsp;the&nbsp;postage&nbsp;stamps&nbsp;size&nbsp;is&nbsp;not&nbsp;large&nbsp;enough,&nbsp;so&nbsp;that&nbsp;the&nbsp;model&nbsp;makes&nbsp;up&nbsp;a&nbsp;significant&nbsp;percentage&nbsp;of&nbsp;the&nbsp;image.&nbsp;One&nbsp;may&nbsp;therefore&nbsp;expect&nbsp;the&nbsp;noise&nbsp;to&nbsp;be&nbsp;too&nbsp;large&nbsp;for&nbsp;small&nbsp;PS&nbsp;sizes.&nbsp;***<br>
&nbsp;<br>
Agrees&nbsp;well&nbsp;with&nbsp;GALSIM&nbsp;noise&nbsp;var&nbsp;on&nbsp;all&nbsp;SNR&nbsp;provided&nbsp;masCentroid&nbsp;is&nbsp;accurately&nbsp;placed&nbsp;on&nbsp;source&nbsp;centre&nbsp;(tested&nbsp;for&nbsp;ellipticity&nbsp;=&nbsp;0.)<br>
&nbsp;<br>
Requires:<br>
--&nbsp;image:&nbsp;Image&nbsp;of&nbsp;source&nbsp;(2-dimensional&nbsp;numpy&nbsp;array)<br>
--&nbsp;maskCentroid:&nbsp;center&nbsp;of&nbsp;mask&nbsp;-&nbsp;used&nbsp;to&nbsp;iteritively&nbsp;mask&nbsp;out&nbsp;source&nbsp;to&nbsp;get&nbsp;an&nbsp;accurate&nbsp;estimate&nbsp;of&nbsp;the&nbsp;background&nbsp;noise&nbsp;after&nbsp;removing&nbsp;the&nbsp;source.&nbsp;If&nbsp;None,&nbsp;then&nbsp;the&nbsp;noise&nbsp;is&nbsp;returned&nbsp;as&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;of&nbsp;the&nbsp;image&nbsp;without&nbsp;masking&nbsp;applied.&nbsp;If&nbsp;not&nbsp;None,&nbsp;then&nbsp;the&nbsp;noise&nbsp;is&nbsp;minimum&nbsp;of&nbsp;the&nbsp;difference&nbsp;between&nbsp;successive&nbsp;runs&nbsp;where&nbsp;the&nbsp;mask&nbsp;is&nbsp;increased&nbsp;by&nbsp;one&nbsp;pixel&nbsp;each&nbsp;side&nbsp;of&nbsp;the&nbsp;centre&nbsp;as&nbsp;passed&nbsp;in.<br>
&nbsp;<br>
Returns:<br>
--&nbsp;result:&nbsp;Scalar&nbsp;giving&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;of&nbsp;the&nbsp;pixel&nbsp;in&nbsp;the&nbsp;input&nbsp;image,&nbsp;after&nbsp;masking&nbsp;(if&nbsp;appropriate).</tt></dd></dl>
 <dl><dt><a name="-find_ML_Estimator"><strong>find_ML_Estimator</strong></a>(image, fitParams<font color="#909090">=None</font>, outputHandle<font color="#909090">=None</font>, setParams<font color="#909090">=None</font>, modelLookup<font color="#909090">=None</font>, searchMethod<font color="#909090">='Powell'</font>, preSearchMethod<font color="#909090">=None</font>, Prior<font color="#909090">=None</font>, bruteRange<font color="#909090">=None</font>, biasCorrect<font color="#909090">=0</font>, bcoutputHandle<font color="#909090">=None</font>, error<font color="#909090">='Fisher'</font>, **iParams)</dt><dd><tt>##-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o----&nbsp;ML&nbsp;Estimation&nbsp;&nbsp;&nbsp;----o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-o-##</tt></dd></dl>
 <dl><dt><a name="-fisher_Error_ML"><strong>fisher_Error_ML</strong></a>(ML, fitParams, image, setParams, modelLookup)</dt></dl>
 <dl><dt><a name="-get_logLikelihood"><strong>get_logLikelihood</strong></a>(parameters, pLabels, image, setParams, modelLookup<font color="#909090">=None</font>, returnType<font color="#909090">='sum'</font>)</dt></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>debug</strong> = False<br>
<strong>verbose</strong> = False<br>
<strong>vverbose</strong> = False</td></tr></table>
</body></html>